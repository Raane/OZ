\insert 'List.oz'
declare
fun {Find Xs Ys}
   local Split in
      if Xs == Ys then
	 nil
      else
	 Split = {SplitTrain Xs Ys.1}
	 {Browse Split}
	 case Split of G#H then
	    trackA({Length H}+1) | trackB({Length G}) | trackA(~{Length H}+1) | trackB(~{Length G}) | {Find Ys.1|Xs.2 Ys}
	 end
      end
      
   end
      
end

fun {SplitTrain Xs Y}
   {Browse Y}
   {Browse Xs}
   local P in
      P = {Position Xs Y}
      {Take Xs P-1}#{Drop Xs P}
   end
end

{Browse {Find [a b] [b a]}}